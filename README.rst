Danbooru Channel Bot
====================

`@DanbooruChannelBot <https://t.me/DanbooruChannelBot>`__ \|
`GitHub <https://github.com/Nachtalb/DanbooruChannelBot>`__

.. contents:: Table of Contents


What I do
---------

I post stuff uploaded to danbooru your chat/channel/group.


Settings
--------

The settings are set via environmental variables. The bot supports ``.env`` files to make life easy. Just copy
``.prod.env`` to ``.env`` and fill in the data you want (optional settigns can be remvoed from the env file)

+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| Option             | Default                                                                                     | Definition                                                           | Required | Type   |
+====================+=============================================================================================+======================================================================+==========+========+
| TELEGRAM_API_TOKEN | ``"XXX"``                                                                                   | Use @BotFather to get a token                                        | yes      | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| ADMINe             | ``"@User1, @User2"``                                                                        | Admins who control the bot                                           | yes      | list   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| CHAT_ID            | ``100000000``                                                                               | Chat id to send posts to                                             | yes      | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
|                    |                                                                                             |                                                                      |          |        |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DOMAIN             | ``"someurl.tdl"``                                                                           | If using webhook domain where the webhook is registered to           | depends  | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| PORT               | ``5050``                                                                                    | If using webhook the port is where the webhook listens on            | depends  | int    |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| AUTO_START         | ``True``                                                                                    | Start the scheduler                                                  | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOW_CHARACTER_TAG | ``True``                                                                                    | Show tags of all characters an the post                              | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOW_ARTIST_TAG    | ``True``                                                                                    | Show the artists tag                                                 | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOW_ID            | ``True``                                                                                    | Show the posts id                                                    | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SEARCH_TAGS        | ``"rating:safe"``                                                                           | Search tags directly used on danbooru (AND filter)                   | no       | list   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| POST_TAG_FILTER    | ``""``                                                                                      | Search tags evaluated by ourselves (OR filter)                       | no       | list   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| MAX_TAGS           | ``10``                                                                                      | Max tags at once (general tags does not limit artist nor characters) | no       | int    |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOWN_TAGS         | ``"1girl, 2girls, 3girls, 4girls, 5girls, 6+girls, highres, blue_eyes, blonde_hair, yuri"`` | Tags that will always be shown if available                          | no       | list   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOW_BUTTONS       | ``True``                                                                                    | Show link buttons to source                                          | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SHOW_DATE          | ``True``                                                                                    | Show post date                                                       | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DATE_FORMAT        | ``%b %-d '%y at %H:%M``                                                                     | Format of the shown date, default looks like: "Apr 4 '20 at 14:08"   | no       | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| LAST_100_TRACK     | ``False``                                                                                   | Track last 100 posts base on SEARCH_TAGS to recognize edited posts   | no       | bool   |
|                    |                                                                                             | that newly match your criteria                                       |          |        |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| SUFFIX             | ``""``                                                                                      | Suffix added to each post                                            | no       | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| RELOAD_INTEVAL     | ``5``                                                                                       | Danbooru reload interval in minutes                                  | no       | int    |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DANBOORU_API       | ``""``                                                                                      | API token for Danbooru                                               | no       | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DANBOORU_USERNAME  | ``""``                                                                                      | Danbooru username                                                    | no       | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DANBOORU_PASSWORD  | ``""``                                                                                      | Danbooru password                                                    | no       | string |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| WEBHOOK            | ``True``                                                                                    | Use webhook mode or polling mode                                     | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+
| DEBUG              | ``False``                                                                                   | Enable debug logging                                                 | no       | bool   |
+--------------------+---------------------------------------------------------------------------------------------+----------------------------------------------------------------------+----------+--------+


- ``string`` are just simple strings, nothing special here
- ``list`` a string with the list items separated by commas
- ``bool``  ``1``, ``true`` and ``yes`` are evaluate as ``True``, everything else is seen as ``False``
- ``int`` string which only consists of integers


Development
-----------

For the project I chose `buildout <http://www.buildout.org/en/latest/contents.html>`__ instead of the default pip way.
I manly did this because it makes installation easier. I recommend to be in an virtualenv for any project, but this is
up to you. Now for the installation:

.. code:: bash

   ln -s development.cfg buildout.cfg
   python bootstrap.py
   bin/buildout

Get a Telegram Bot API Token > `@BotFather <https://t.me/BotFather>`__ and fill in the settings as described above.

To run the bot simply run

.. code:: bash

   bin/bot


Copyright
---------

Thank you for using `@DanbooruChannelBot <https://t.me/DanbooruChannelBot>`__.

Made by `Nachtalb <https://github.com/Nachtalb>`_ | This extension licensed under the `GNU General Public License v3.0 <https://github.com/Nachtalb/DanbooruChannelBot/blob/master/LICENSE>`_.
